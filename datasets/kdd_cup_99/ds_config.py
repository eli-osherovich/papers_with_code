import numpy as np
import pandas as pd

from .. import dataset

# flake8: noqa: E501
# pylint: disable=line-too-long

INT_TYPE = np.int32
FLOAT_TYPE = np.float32
BOOL_TYPE = np.int32
CATEGORICAL_TYPE = pd.CategoricalDtype

feature_dict = {
  "duration":
    INT_TYPE,
  "protocol_type":
    CATEGORICAL_TYPE(["icmp", "tcp", "udp"]),
  "service":
    CATEGORICAL_TYPE([
      "aol",
      "auth",
      "bgp",
      "courier",
      "csnet_ns",
      "ctf",
      "daytime",
      "discard",
      "domain",
      "domain_u",
      "echo",
      "eco_i",
      "ecr_i",
      "efs",
      "exec",
      "finger",
      "ftp",
      "ftp_data",
      "gopher",
      "harvest",
      "hostnames",
      "http",
      "http_2784",
      "http_443",
      "http_8001",
      "icmp",
      "imap4",
      "IRC",
      "iso_tsap",
      "klogin",
      "kshell",
      "ldap",
      "link",
      "login",
      "mtp",
      "name",
      "netbios_dgm",
      "netbios_ns",
      "netbios_ssn",
      "netstat",
      "nnsp",
      "nntp",
      "ntp_u",
      "other",
      "pm_dump",
      "pop_2",
      "pop_3",
      "printer",
      "private",
      "red_i",
      "remote_job",
      "rje",
      "shell",
      "smtp",
      "sql_net",
      "ssh",
      "sunrpc",
      "supdup",
      "systat",
      "telnet",
      "tftp_u",
      "time",
      "tim_i",
      "urh_i",
      "urp_i",
      "uucp",
      "uucp_path",
      "vmnet",
      "whois",
      "X11",
      "Z39_50",
    ]),
  "flag":
    CATEGORICAL_TYPE([
      "OTH",
      "REJ",
      "RSTO",
      "RSTOS0",
      "RSTR",
      "S0",
      "S1",
      "S2",
      "S3",
      "SF",
      "SH",
    ]),
  "src_bytes":
    INT_TYPE,
  "dst_bytes":
    INT_TYPE,
  "land":
    BOOL_TYPE,
  "wrong_fragment":
    INT_TYPE,
  "urgent":
    INT_TYPE,
  "hot":
    INT_TYPE,
  "num_failed_logins":
    INT_TYPE,
  "logged_in":
    BOOL_TYPE,
  "num_compromised":
    INT_TYPE,
  "root_shell":
    BOOL_TYPE,
  "su_attempted":
    INT_TYPE,
  "num_root":
    INT_TYPE,
  "num_file_creations":
    INT_TYPE,
  "num_shells":
    INT_TYPE,
  "num_access_files":
    INT_TYPE,
  "num_outbound_cmds":
    INT_TYPE,
  "is_hot_login":
    BOOL_TYPE,
  "is_guest_login":
    BOOL_TYPE,
  "count":
    INT_TYPE,
  "srv_count":
    INT_TYPE,
  "serror_rate":
    FLOAT_TYPE,
  "srv_serror_rate":
    FLOAT_TYPE,
  "rerror_rate":
    FLOAT_TYPE,
  "srv_rerror_rate":
    FLOAT_TYPE,
  "same_srv_rate":
    FLOAT_TYPE,
  "diff_srv_rate":
    FLOAT_TYPE,
  "srv_diff_host_rate":
    FLOAT_TYPE,
  "dst_host_count":
    INT_TYPE,
  "dst_host_srv_count":
    INT_TYPE,
  "dst_host_same_srv_rate":
    FLOAT_TYPE,
  "dst_host_diff_srv_rate":
    FLOAT_TYPE,
  "dst_host_same_src_port_rate":
    FLOAT_TYPE,
  "dst_host_srv_diff_host_rate":
    FLOAT_TYPE,
  "dst_host_serror_rate":
    FLOAT_TYPE,
  "dst_host_srv_serror_rate":
    FLOAT_TYPE,
  "dst_host_rerror_rate":
    FLOAT_TYPE,
  "dst_host_srv_rerror_rate":
    FLOAT_TYPE,
  "label":
    CATEGORICAL_TYPE([
      "apache2.",
      "back.",
      "buffer_overflow.",
      "ftp_write.",
      "guess_passwd.",
      "httptunnel.",
      "imap.",
      "ipsweep.",
      "land.",
      "loadmodule.",
      "mailbomb.",
      "mscan.",
      "multihop.",
      "named.",
      "neptune.",
      "nmap.",
      "normal.",
      "perl.",
      "phf.",
      "pod.",
      "portsweep.",
      "processtable.",
      "ps.",
      "rootkit.",
      "saint.",
      "satan.",
      "sendmail.",
      "smurf.",
      "snmpgetattack.",
      "snmpguess.",
      "spy.",
      "sqlattack.",
      "teardrop.",
      "udpstorm.",
      "warezclient.",
      "warezmaster.",
      "worm.",
      "xlock.",
      "xsnoop.",
      "xterm.",
    ]),
}

SPLITS = {
  "train_10p":
    dataset.DatasetFile(
      uri="http://kdd.ics.uci.edu/databases/kddcup99/kddcup.data_10_percent.gz",
      checksum="8045aca0d84e70e622d1148d7df782496f6333bf6eb979a1b0837c42a9fd9561",
      file_reader_args={
        "names": feature_dict,
        "dtype": feature_dict
      }
    ),
  "train":
    dataset.DatasetFile(
      uri="http://kdd.ics.uci.edu/databases/kddcup99/kddcup.data.gz",
      checksum="3b6c942aa0356c0ca35b7b595a26c89d343652c9db428893e7494f837b274292",
      file_reader_args={
        "names": feature_dict,
        "dtype": feature_dict
      }
    ),
  "test":
    dataset.DatasetFile(
      uri="http://kdd.ics.uci.edu/databases/kddcup99/corrected.gz	",
      checksum="abd8165508378859b07e38537271f0ebf8a4d7319f643188cd7361e939a05c43",
      file_reader_args={
        "names": feature_dict,
        "dtype": feature_dict
      }
    ),
}
